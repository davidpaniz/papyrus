<?xml version="1.0" encoding="utf-8"?>
<mx:ComboBox xmlns:mx="http://www.adobe.com/2006/mxml" creationComplete="init()" labelFunction="showI18NLabel">
	<mx:Script >
		<![CDATA[
			import org.papyrus.screen.notification.MailNotificationScreen;
			import org.papyrus.screen.incident.WorkOrderForm;
			import org.papyrus.screen.incident.OpenIncidentScreen;
			import org.papyrus.components.containers.ConditionComparableScreen;
			import mx.events.ListEvent;
			import mx.messaging.AbstractConsumer;
			import mx.collections.ArrayCollection;
			
			private var staticDataProvider:ArrayCollection = new ArrayCollection();
			
			private function init():void {
				staticDataProvider.addItem("INCIDENT");
				staticDataProvider.addItem("WORK_ORDER");
				staticDataProvider.addItem("MAIL_NOTIFICATION");
				
				dataProvider = staticDataProvider;
			}
			
			private function showI18NLabel(item:Object):String {
				return resourceManager.getString('businessRule', item.toString());
			}
			
			override public function set selectedItem( param:Object ):void
			{
				super.selectedItem = 1;
				var count:int = 0;
				for each( var obj:Object in staticDataProvider )
				{
					if( obj && obj == param )
					{
						selectedIndex = count;
						dispatchEvent( new ListEvent( ListEvent.CHANGE ) );
						return;
					}
					count++;
				}
	
				// It was not found
				super.selectedIndex = 0;
			}
			
			public function detailForm():ConditionComparableScreen
			{
				//TODO refactoring please! Should use inheritance
				var item:String = this.selectedItem.toString();
				
				if(item == "INCIDENT") {
					return new OpenIncidentScreen();
				} else if(item == "WORK_ORDER") {
					return new WorkOrderForm();
				} else {
					return new MailNotificationScreen();
				}
			}
			
		]]>
	</mx:Script>
		
	
</mx:ComboBox>
